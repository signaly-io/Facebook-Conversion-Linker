___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Facebook Conversion Linker",
  "categories": [
    "ANALYTICS",
    "CONVERSIONS"
  ],
  "brand": {
    "id": "github.com_signaly-io",
    "displayName": "Signaly",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAJxCAYAAADRrrIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAEQhJREFUeNrs3U9SFNkaxuGvjDtyRI+cVq+gcQW3mBvRuIIuV6CuAFyBsgKqVyAD59ArkLuCrqkjGTm+50gWpFiK9YeqrPyeJyKDERokBD9OmS9GAAAAAAAAAAAAAAAAAAAAAAAAAAAAfTBwC4Bd8fjZp73yZlyuPXeDlrMvH55cCiHQ9wgelzdH7gQ/imG5XpQgXi36jv9x74AdiOBpcxKEHzks17BcTxd9x0fuHSCC9MR+88qBEAIiSFovhRAQQTLbK187+0IIiCCpYyiEgAiCEAIiCEIIiCAIISCCIISACIIQAiIIQgiIIAghIIIghIAIIoRuASCCCCGACCKEACKIEAKIIEIIIIIIIYAIIoQAIogQAoggQgggggghgAgihAAiiBACiCBCCIigCCKEgAiCEAIiCEIIiCAIISCCIISACIIQAiIIQgiIIAghIIIghIAIghACIghCCIggCCEggiCEgAiCEAIiCEIIiCAIISCCIISACIIQAiIIQgiIIAghIIIghIAIghACIghCCIggCCEggiCEgAiCEAIiCEIIiCAIISCCIIQggiIIQggiCAghiCAghCCCgBCCCAJCCCIICCGIICCEIIKAEIIIAkIIIggIIYggCCEggiCEgAiCEAIiCEIIiCAIISCCIISACIIQAiIIQgiIIAghIIIghIAIghACIghCCIggCCEggiCEgAiCEAIiCEIIiCAIISCCIIQggiIIQggiCAghiCAghCCCgBCCCAJCCCIICCGIICCEIIKAEIIIAkIIIggIIYggIIQggoAQgggCQggiCAghiCAghCCCgBCCCAJCCCIICCGIICCEIIKAEIIIAkIIIggIIYggIIQggoAQgggCQggiCAghiCAghCCCgBCCCAJCiAiKICCEiCCAECKCAEKICAIIISIIIISIICCEIIKAEIIIAkIIIggIIYggIIQggoAQgggCQggiCAghiCAghCCCgBCCCAJCCCIICCGIICCEIIKAEIIIAkIIIggIIYggIIQggoAQgggCQggiCAghiCAghCCCgBCCCAJCCCIICCEiKIKAECKCAEKICAIIISIIIISIIIAQIoIAQogIAgghIggghIgg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\u003d"
  },
  "description": "This tag will collect FBCLID from the page URL and store it in the cookies. Also generate FBP \u0026 FBC cookie",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "pageLocation",
    "displayName": "Page Location",
    "simpleValueType": true,
    "help": "Put the page location from where you want to capture fbclid. If empty it will auto collect from page URL."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const copyFromWindow = require('copyFromWindow');



const onSuccess = () => {
let clientParamBuilder = copyFromWindow('clientParamBuilder');
  
if(data.pageLocation){
clientParamBuilder.processAndCollectAllParams(data.pageLocation);
}else{
clientParamBuilder.processAndCollectAllParams();
}
  data.gtmOnSuccess();  
};

const onFailure = () => {
  data.gtmOnFailure();  
};

injectScript('https://capi-automation.s3.us-east-2.amazonaws.com/public/client_js/capiParamBuilder/clientParamBuilder.bundle.js', onSuccess, onFailure, 'fbPixel');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "clientParamBuilder"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://capi-automation.s3.us-east-2.amazonaws.com/public/client_js/capiParamBuilder/clientParamBuilder.bundle.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 25/07/2025, 11:39:30


